library(readxl)
read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx')
read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = 2)
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = 2)
View(df)
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = c(1, 2, 4, 5))
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = 2)
View(df)
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = 2)[-1:2, ]
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx', sheet = "Cuadro 2.1", skip = 2)[-(1:2), ]
View(df)
library(tidyverse)
View(df)
unique(df$Edad)
View(df)
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx',
sheet = "Cuadro 2.1",
skip = 2)[-c(1, 2, 104, 105), ]
View(df)
df$Edad
as.numeric(df$Edad)
df$Edad <- gsub("100 y más", "100", df$Edad)
df <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx',
sheet = "Cuadro 2.1",
skip = 2)[-c(1, 2, 104, 105), ]
df$Edad <- gsub("100 y más", "100", df$Edad)
df$Edad <- as.numeric(df$Edad)
df$Edad
df$GrupoEdad <- cut(
df$Edad,
breaks = c(seq(0, 90, by = 10), Inf),
right  = FALSE,                 # intervalos [0,10), [10,20), ...
labels = c(paste0(seq(0, 80, 10), " a ", seq(9, 89, 10)), "90 y más")
)
View(df)
data <- read_excel('data/proyecciones_nacionales_2022_2040_c1_c2.xlsx',
sheet = "Cuadro 2.1",
skip = 2)[-c(1, 2, 104, 105), ]
df <- data
df$Edad <- gsub("100 y más", "100", df$Edad)
df$Edad <- as.numeric(df$Edad)
df$Edad
df$GrupoEdad <- cut(
df$Edad,
breaks = c(seq(0, 90, by = 10), Inf),
right  = FALSE,                 # intervalos [0,10), [10,20), ...
labels = c(paste0(seq(0, 80, 10), " a ", seq(9, 89, 10)), "90 y más")
)
df_long <- df %>%
select(-Edad) %>%                                   # eliminar Edad
pivot_longer(
cols = -GrupoEdad,                                # unpivot todo menos GrupoEdad
names_to = "Año",
values_to = "Poblacion"
) %>%
mutate(
Año = as.integer(Año),
Poblacion = as.numeric(Poblacion)
) %>%
group_by(GrupoEdad, Año) %>%
summarise(Poblacion = sum(Poblacion, na.rm = TRUE), .groups = "drop") %>%
group_by(Año) %>%
mutate(
Porcentaje = Poblacion / sum(Poblacion, na.rm = TRUE)
) %>%
ungroup()
View(df_long)
df_grupos <- df %>%
select(-Edad) %>%
group_by(GrupoEdad) %>%
summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE)), .groups = "drop") %>%
mutate(across(where(is.numeric), ~ .x / sum(.x, na.rm = TRUE)))
View(df_grupos)
hist(df_grupos$2022)
hist(df_grupos[2])
hist(df_grupos[[2]])
hist(df_grupos[[20]])
barplot(df_grupos$GrupoEdad, df_grupos[[2]])
df_grupos[[2]]
plot(df_grupos$GrupoEdad, df_grupos[[2]])
plot(df_grupos$GrupoEdad, df_grupos[[20]])
plot(df_grupos$GrupoEdad, df_grupos[[2]])
plot(df_grupos$GrupoEdad, df_grupos[[20]])
plot(df_grupos$GrupoEdad, df_grupos[[2]])
plot(df_grupos$GrupoEdad, df_grupos[[20]])
plot(df_grupos$GrupoEdad, df_grupos[[2]])
plot(df_grupos$GrupoEdad, df_grupos[[20]])
plot(df_grupos$GrupoEdad, df_grupos[[2]])
plot(df_grupos$GrupoEdad, df_grupos[[20]])
View(df_grupos)
write.csv(df_grupos, "datos-poblacion.csv", row.names = FALSE)
View(df_grupos)
